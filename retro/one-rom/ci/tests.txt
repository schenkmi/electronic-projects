# Test combinations for build system validation
# Format: test_name:MCU=variant,VAR1=val1,VAR2=val2,CONFIG=config/file.mk
# Lines starting with # are ignored
#
# MCU variant is required for each test
# CONFIG is optional - if not specified, no config is passed to make
# Other environment variables are optional

# All variants without config (uses Makefile default)
no-config-f401rb:HW_REV=ice-24-f,MCU=f401rb
no-config-f401rc:HW_REV=ice-24-f,MCU=f401rc
no-config-f411rc:HW_REV=ice-24-f,MCU=f411rc
no-config-f411re:HW_REV=ice-24-f,MCU=f411re
no-config-f405rg:HW_REV=ice-24-f,MCU=f405rg
no-config-f405rg:HW_REV=ice-24-f,MCU=f446rc
no-config-f446re:HW_REV=ice-24-f,MCU=f446re
no-config-rp2350:HW_REV=fire-24-a,MCU=rp2350
no-config-rp2350:HW_REV=fire-24-usb-b,MCU=rp2350

# Use test config, one of each STM32F4 variant
basic-f401rc:HW_REV=ice-24-f,MCU=f401rc,CONFIG=config/test-sdrr-0.mk
basic-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/test-sdrr-0.mk
basic-f405rg:HW_REV=ice-24-f,MCU=f405rg,CONFIG=config/test-sdrr-0.mk
basic-f446re:HW_REV=ice-24-f,MCU=f446re,CONFIG=config/test-sdrr-0.mk

# Enable MCO, one of each STM32F4 variant
mco-f401re:HW_REV=ice-24-f,MCO=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
mco-f411re:HW_REV=ice-24-f,MCO=1,MCU=f411re,CONFIG=config/test-sdrr-0.mk
mco-f405rg:HW_REV=ice-24-f,MCO=1,MCU=f405rg,CONFIG=config/test-sdrr-0.mk
mco-f446re:HW_REV=ice-24-f,MCO=1,MCU=f446re,CONFIG=config/test-sdrr-0.mk

# Disable BOOT_LOGGGING
no-boot-logging-f411re:HW_REV=ice-24-f,BOOT_LOGGING=0,MCU=f411re,CONFIG=config/test-sdrr-0.mk
no-boot-logging-rp2350:HW_REV=fire-24-a,BOOT_LOGGING=0,MCU=rp2350,CONFIG=config/test-sdrr-0.mk
no-boot-logging-rp2350:HW_REV=fire-24-usb-b,BOOT_LOGGING=0,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Disable BOOT_LOGGGING and SWD
no-boot-logging-no-swd-f401re:HW_REV=ice-24-f,BOOT_LOGGING=0,SWD=0,MCU=f401re,CONFIG=config/test-sdrr-0.mk

# PCB revisions
pcb-rev-d:HW_REV=ice-24-d,STATUS_LED=0,MCU=f401re,CONFIG=config/test-sdrr-0.mk
pcb-rev-e:HW_REV=ice-24-e,MCU=f401re,CONFIG=config/test-sdrr-0.mk
pcb-rev-f:HW_REV=ice-24-f,MCU=f401re,CONFIG=config/test-sdrr-0.mk
pcb-rev-g:HW_REV=ice-24-g,MCU=f401re,CONFIG=config/test-sdrr-0.mk
pcb-rev-h:HW_REV=ice-24-usb-h,MCU=f401re,CONFIG=config/test-sdrr-0.mk
pcb-rev-pa:HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/test-sdrr-0.mk
pcb-rev-pa:HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Enable BOOT_LOGGGING
boot-logging-f401re:HW_REV=ice-24-f,BOOT_LOGGING=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
boot-logging-rp2350:HW_REV=fire-24-a,BOOT_LOGGING=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Enable DEBUG_LOGGING
debug-logging-f401re:HW_REV=ice-24-f,DEBUG_LOGGING=1,BOOT_LOGGING=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
debug-logging-rp2350:HW_REV=fire-24-a,DEBUG_LOGGING=1,BOOT_LOGGING=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Enable MAIN_LOOP_LOGGING
main-loop-logging-f401re:HW_REV=ice-24-f,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
main-loop-logging-rp2350:HW_REV=fire-24-a,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Enable MAIN_LOOP_ONE_SHOT
main-loop-one-shot-f401re:HW_REV=ice-24-f,MAIN_LOOP_ONE_SHOT=1,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
main-loop-one-shot-debug-f401re:HW_REV=ice-24-f,DEBUG_LOGGING=1,MAIN_LOOP_ONE_SHOT=1,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
main-loop-one-shot-rp2350:HW_REV=fire-24-a,MAIN_LOOP_ONE_SHOT=1,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk
main-loop-one-shot-debug-rp2350:HW_REV=fire-24-a,DEBUG_LOGGING=1,MAIN_LOOP_ONE_SHOT=1,MAIN_LOOP_LOGGING=1,BOOT_LOGGING=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# DISABLE_PRELOAD_TO_RAM
disable-preload-to-ram-f401re:HW_REV=ice-24-f,DISABLE_PRELOAD_TO_RAM=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
disable-preload-to-ram-rp2350:HW_REV=fire-24-a,DISABLE_PRELOAD_TO_RAM=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Disable status LED
disable-status-led-f401re:HW_REV=ice-24-e,DISABLE_STATUS_LED=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
disable-status-led-f401re:HW_REV=ice-24-f,DISABLE_STATUS_LED=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
disable-status-led-f401re:HW_REV=ice-24-g,DISABLE_STATUS_LED=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
disable-status-led-f401re:HW_REV=ice-24-usb-h,DISABLE_STATUS_LED=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
disable-status-led-rp2350:HW_REV=fire-24-a,DISABLE_STATUS_LED=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Custom frequencies
freq-50mhz-f401re:HW_REV=ice-24-f,FREQ=50,MCU=f401re,CONFIG=config/test-sdrr-0.mk
freq-92mhz-f411re:HW_REV=ice-24-f,FREQ=92,MCU=f411re,CONFIG=config/test-sdrr-0.mk
freq-130mhz-f405rg:HW_REV=ice-24-f,FREQ=130,MCU=f405rg,CONFIG=config/test-sdrr-0.mk
freq-170mhz-f446re:HW_REV=ice-24-f,FREQ=160,MCU=f446re,CONFIG=config/test-sdrr-0.mk
freq-100mhz-rp2350:HW_REV=fire-24-a,FREQ=100,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Overclocking
overclock-f401re:HW_REV=ice-24-f,OVERCLOCK=1,FREQ=100,MCU=f401re,CONFIG=config/test-sdrr-0.mk
overclock-f411re:HW_REV=ice-24-f,OVERCLOCK=1,FREQ=110,MCU=f411re,CONFIG=config/test-sdrr-0.mk
overclock-f405rg:HW_REV=ice-24-f,OVERCLOCK=1,FREQ=250,MCU=f405rg,CONFIG=config/test-sdrr-0.mk
overclock-f446re:HW_REV=ice-24-f,OVERCLOCK=1,FREQ=400,MCU=f446re,CONFIG=config/test-sdrr-0.mk
overclock-rp2350:HW_REV=fire-24-a,OVERCLOCK=1,FREQ=300,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Build with different serve algorithms
serve-algorithm-a-f401re:HW_REV=ice-24-f,SERVE_ALG=a,MCU=f401re,CONFIG=config/test-sdrr-0.mk
serve-algorithm-b-f401re:HW_REV=ice-24-f,SERVE_ALG=b,MCU=f401re,CONFIG=config/test-sdrr-0.mk

# Build with c main loop - not supported in production, but want to keep compiling
c-main-loop-f405rg:HW_REV=ice-24-f,EXTRA_C_FLAGS=-DC_MAIN_LOOP,COUNT_ROM_ACCESS=0,MCU=f405rg,CONFIG=config/bank-1541.mk

# Build without COUNT_ROM_ACCESS
no-count-rom-access-f401re:HW_REV=ice-24-f,COUNT_ROM_ACCESS=0,MCU=f401re,CONFIG=config/test-sdrr-0.mk

# Build with DISABLE_CCM
disable-ccm-f405rg:HW_REV=ice-24-f,EXTRA_C_FLAGS=-DDISABLE_CCM,MCU=f405rg,CONFIG=config/test-sdrr-0.mk

# Build with EXECUTE_FROM_RAM
execute-from-ram-f401re:HW_REV=ice-24-f,EXTRA_C_FLAGS=-DEXECUTE_FROM_RAM,MCU=f401re,CONFIG=config/test-sdrr-0.mk
execute-from-ram-rp2350:HW_REV=fire-24-a,EXTRA_C_FLAGS=-DEXECUTE_FROM_RAM,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Test each config (except those requiring licenses and not sets)
test-1541-f411re:HW_REV=ice-24-f,MCU=f401re,CONFIG=config/1541.mk
test-2040-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/2040.mk
test-4040-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/4040.mk
test-c64-no-destestmax-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/c64-no-destestmax.mk
test-ieee-diag-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/ieee-diag.mk
test-pet-4-40-50-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/pet-4-40-50.mk
test-vic20-pal-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/vic20-pal.mk
test-vic20-ntsc-rp2350:HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/vic20-ntsc.mk
test-vic20-ntsc-rp2350:HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/vic20-ntsc.mk

# Test old config set letters
test-hw-rev-D:HW_REV=d,STATUS_LED=0,MCU=f411re,CONFIG=config/test-sdrr-0.mk
test-hw-rev-E:HW_REV=e,MCU=f411re,CONFIG=config/test-sdrr-0.mk
test-hw-rev-F:HW_REV=f,MCU=f411re,CONFIG=config/test-sdrr-0.mk

# Test each set config - HW_REV=ice-24-f only
test-set-c64-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/set-c64.mk
test-set-vic20-pal-rp2350:HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/set-vic20-pal.mk

# Test each bank switching config
bank-1541-f405rg:MCU=f405rg,HW_REV=f,CONFIG=config/bank-1541.mk
bank-c64-char-f405rg:MCU=f405rg,HW_REV=f,CONFIG=config/bank-c64-char.mk
bank-vic20-char-f405rg:MCU=f405rg,HW_REV=f,CONFIG=config/bank-vic20-char.mk
bank-c64-char-fun-f405rg:MCU=f405rg,HW_REV=f,CONFIG=config/bank-c64-char-fun.mk
bank-vic20-char-fun-f405rg:HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/bank-vic20-char-fun.mk

# Test RP2350 GPIO coprocessor support
rp-use-cp-rp2350:EXTRA_C_FLAGS=-DRP_USE_CP=1,MCU=rp2350,HW_REV=fire-24-a,CONFIG=config/test-sdrr-0.mk

# Build with EXCLUDE_METADATA (no metadata or ROM images included in firmware)
exclude-metadata-f401re:HW_REV=ice-24-f,EXCLUDE_METADATA=1,MCU=f401re,CONFIG=config/test-sdrr-0.mk
exclude-metadata-rp2350:HW_REV=fire-24-a,EXCLUDE_METADATA=1,MCU=rp2350,CONFIG=config/test-sdrr-0.mk

# Test third party configs - put them last as they often fail for me
test-3p-ti994a-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/third-party/ti994a.mk
test-3p-coco2-f411re:HW_REV=ice-24-f,MCU=f411re,CONFIG=config/third-party/coco2.mk

# Test ice-28-a PCB revision (28 pin ROM support, prototype only)
# Can't do yet - unsuppored by make test
#ice-28-a-f446rc-c64c:HW_REV=ice-28-a,MCU=f446rc,CONFIG=config/28-c64c.mk
#ice-28-a-f446rc-c1541ii:HW_REV=ice-28-a,MCU=f446rc,CONFIG=config/28-541ii.mk

# PIO tests
pio-1:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_DEFAULT",HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/c64-no-destestmax.mk
pio-2:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_DEFAULT",HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-3:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_SLOW_CLOCK_KERNAL",HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-4:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_SLOW_CLOCK_CHAR",HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-5:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_NO_DMA",HW_REV=fire-24-a,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-6:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_DEFAULT",HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/c64-no-destestmax.mk
pio-7:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_DEFAULT",HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-8:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_SLOW_CLOCK_KERNAL",HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-9:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_SLOW_CLOCK_CHAR",HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/vic20-pal.mk
pio-10:EXTRA_C_FLAGS="-DRP_PIO -DPIO_CONFIG_NO_DMA",HW_REV=fire-24-usb-b,MCU=rp2350,CONFIG=config/vic20-pal.mk
